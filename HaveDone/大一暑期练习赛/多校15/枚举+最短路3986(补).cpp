#include <stdio.h>//²¹ HDU 3986 Ã¶¾Ù+×î¶ÌÂ·¡£#include <stdlib.h>#include <time.h>#include <vector>#include <iostream>using namespace std;const int N = 1002;const int inf = 1000000000;int mat1[N][N],mat2[N][N];int n,m;int pre[N*10],d[N];bool vis[N],f;int qu[1000000];void spfa(){	int i,head=0,tail=1;	for(i=1 ; i <= n ; ++i){		vis[i] = false;		d[i]=inf;		if(f)pre[i]=-1;	}	d[1] = 0;	qu[0] = 1;	while(tail > head){		int u = qu[head];		vis[u] = true;		for(i=1 ; i <= n ; ++i){			if(d[i] > d[u] + mat1[u][i]){				d[i] = d[u] + mat1[u][i];				if(f)pre[i] = u;				if(!vis[i]){					vis[i] = true;					qu[tail++] = i;				}			}		}		vis[u] = false;		head++;	}}int main(){	int T,i,j,u,v,c;	scanf("%d",&T);	while(T--)	{		scanf("%d%d",&n,&m);		for(i=1 ; i <= n ; ++i)			for(j=1 ; j <= n ; ++j)				mat1[i][j]=mat2[i][j]=inf;		for(i=1 ; i <= m ; ++i){			scanf("%d%d%d",&u,&v,&c);			if(mat1[u][v]!=inf || mat1[v][u]!=inf)				mat2[u][v] = mat2[v][u] = min(mat2[u][v],max(mat1[u][v],c));			if(mat1[u][v] > c)				mat1[u][v] = mat1[v][u] = c;		}		f = true;		spfa();		f = false;		if(d[n]==inf){			printf("-1\n");			continue;		}		int p=n,temp,ans=0;		for(int p=n ; p!=-1 ; p=pre[p]){			int v = pre[p];			temp = mat1[v][p];			mat1[v][p] = mat1[p][v] = mat2[v][p];			spfa();			if(d[n]==inf) break;			ans = max(ans,d[n]);			mat1[v][p] = mat1[p][v] = temp;		}		if(!ans)printf("-1\n");		else printf("%d\n",ans);	}	return 0;}/*3441 2 52 4 101 3 33 4 8321 2 52 3 10221 2 11 2 2231 2 31 2 21 2 1231 2 31 2 11 2 2*/