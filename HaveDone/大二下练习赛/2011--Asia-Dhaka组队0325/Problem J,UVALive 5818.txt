#include <cstdio>#include <cstdlib>#include <cstring>#include <iostream>#include <algorithm>#include <vector>using namespace std;int val[110],use[110];vector<int> edge[110];int tail,ans;void dfs(int u){    use[u]=1;    int f=0,k;    for(int i=0;i<edge[u].size();++i){        int v=edge[u][i];        if(use[v]) continue;        if(!f){            f=1;            k=v;        }        else if(val[k]<val[v]||            val[k]==val[v]&&k>v) k=v;    }    if(!f) tail=u;    else{        ans+=val[k];        dfs(k);    }}int main(){    int n,T,m,cs=0;    scanf("%d",&T);    while(T--){        scanf("%d%d",&n,&m);        for(int i=0;i<n;++i){            scanf("%d",&val[i]);            edge[i].clear();        }        while(m--){            int a,b;            scanf("%d%d",&a,&b);            edge[a].push_back(b);        }        memset(use,0,sizeof(use));        use[0]=1;        tail=0,ans=val[0];        dfs(0);        printf("Case %d: %d %d\n",++cs,ans,tail);    }    return 0;}